function showParam(){console.log("N = "+N+"\nLen = "+Len+"\nD = "+D+"\nV = "+V+"\ntotalV = "+totalV+"\n")}function showWebStoreData(){for(var t=parseInt(localStorage.getItem("storeN")),a=1;t+1>a;a++)console.log(localStorage.getItem("Num"+a)),console.log(localStorage.getItem("Len"+a)),console.log(localStorage.getItem("Diam"+a)),console.log(localStorage.getItem("Val"+a))}function errorMessages(t){$(".error").text(t).fadeIn().delay(2e3).fadeOut()}function allReset(){Len=0,N=1,$(".num").text("№ "+N),D=0,V=0,totalV=0,$("#total_val").val(0),$("#total_val_top").val(0),localStorage.removeItem("maxVal"),maxV=0,$("#max-val").val(0),restVal=0,$("#max-val-rest").val($("#max-val").val()).css("backgroundColor","white"),$(".aver-diam").text("0"),$("#aver-persent-4,#aver-persent-6,#aver-qty-4,#aver-qty-6,#aver-val-4,#aver-val-6,#aver-val").val("0"),localStorage.removeItem("Styk"),resetContainerData(),removeDataTable()}function allMelcodrevReset(){$("#diam12").val("0"),$("#val12").val("0"),$("#diam14").val("0"),$("#val14").val("0"),$("#diam16").val("0"),$("#val16").val("0"),$("#diam18").val("0"),$("#val18").val("0"),$("#diam_total").val("0"),$("#val_total").val("0")}function showData(){for(var t=N-1;t>0;t--)t==N-1?tempTotalVal=totalV:tempTotalVal-=Partia[t+1].Val,Partia[t].Diam>0&&$(".table-res").append("<tr><td><b>"+t+"</b></td><td>"+localStorage.getItem("Len"+t).toLocaleString()+"</td><td><b>"+localStorage.getItem("Diam"+t).toLocaleString()+"</b></td><td>"+localStorage.getItem("Val"+t).toLocaleString()+"</td><td><b>"+tempTotalVal.toLocaleString()+"</b></td><td>"+t+"</td></tr>")}function removeDataTable(){$("#show_loading").text("ПОКАЗАТЬ"),$(".table-res tr td").remove(),flag=!0}function showDataAfterSave(){N--,showData(),N++}function showDataASC(){$(".table-res").append("<tr><td>"+N+"</td><td>"+Len/10+"</td><td>"+D+"</td><td>"+V+"</td><td>"+totalV+'</td><td><i class="fa fa-minus-square del"></i></td></tr>')}function totalRest(){maxV=localStorage.getItem("maxVal"),restVal=maxV-totalV,$("#max-val-rest").val(restVal.toLocaleString()),$("#max-val-rest").css(attention>restVal?{backgroundColor:"red",color:"white"}:{backgroundColor:"white",color:"black"})}function resetContainerData(){contNum=$("#cont-num").val(""),contLine=$("#cont-line").val(""),contGross=$("#gross-wt").val(""),contTare=$("#tare-wt").val(""),contPay=$("#pay-wt").val(""),contPoroda=$("#cont-poroda").val(""),Employer=$("#emp-name").val(""),localStorage.setItem("contNum",0),localStorage.setItem("contLine",0),localStorage.setItem("contGross",0),localStorage.setItem("contTare",0),localStorage.setItem("contPay",0),localStorage.setItem("contPoroda",0),localStorage.setItem("Employer",0)}function getAverageDiam(){for(var t=0,a=0,e=0,o=0,l=0,r=0,n=1;N>=n;n++)t+=parseInt(Partia[n].Diam),a+=parseInt(Partia[n].Val),3==parseInt(Partia[n].L)?(o++,e+=parseInt(Partia[n].Val)):5==parseInt(Partia[n].L)&&(r++,l+=parseInt(Partia[n].Val));t/=N,t=Math.round(100*t)/100,$(".aver-diam").text(t.toLocaleString()),a/=N,a=Math.round(100*a)/100,$("#aver-val").val(a.toLocaleString()+" см3"),$("#aver-qty-4").val(o.toLocaleString()+" шт"),$("#aver-qty-6").val(r.toLocaleString()+" шт"),$("#aver-val-4").val(e.toLocaleString()+" см3"),$("#aver-val-6").val(l.toLocaleString()+" см3"),e=100*e/totalV,e=Math.round(100*e)/100,l=100*l/totalV,l=Math.round(100*l)/100,$("#aver-persent-4").val(e.toLocaleString()+" %"),$("#aver-persent-6").val(l.toLocaleString()+" %")}function getValue(){if(temp_diam=$("#diam").val(),!(temp_diam%2)){switch(D=$("#diam").val(),Len){case"38":V=L_3_8[D];break;case"58":V=L_5_8[D]}V?$("#val").val(V+"cм3"):(0>D||D>9)&&errorMessages("НЕТ ДАННЫХ ДЛЯ ДИАМЕТРА")}}function TestKeyBoard(t){console.log("***********************************\n"+t+"\n значение в поле(Diam) = "+Diam+"\n диаметр бревна(D) = "+D+"\n объем бревна(V) = "+V+"\n нажали кнопку(diam_temp) = "+diam_temp+"\n новое значение диаметра(temp_diam) = "+temp_diam)}var contNum="",contLine="",contGross="",contTare="",contPay="",contPoroda="",Employer="",Len=0,N=1,Styk=[],styk_i=0,D=0,V=0,Partia=[],WebStore=[],storeNum=0,storeLen=0,storeDiam=0,storeVal=0,totalV=0;$("#total_val").val(0),$("#total_val_top").val(0);var tempTotalVal=0,maxV=0;$("#max-val").val(0);var restVal=0;$("#max-val-rest").val($("#max-val").val());var attention=2e3;if(localStorage.getItem("storeN")){errorMessages("Данные восстановлены"),console.log("!!!В ХРАНЛИЩЕ ЕСТЬ СОХРАНЕННЫЕ ДАННЫЕ!!!"),contNum=localStorage.getItem("contNum"),contLine=localStorage.getItem("contLine"),contGross=localStorage.getItem("contGross"),contTare=localStorage.getItem("contTare"),contPay=localStorage.getItem("contPay"),contPoroda=localStorage.getItem("contPoroda"),Employer=localStorage.getItem("Employer"),$("#cont-num").val(contNum),$("#cont-line").val(contLine),$("#gross-wt").val(contGross),$("#tare-wt").val(contTare),$("#pay-wt").val(contPay),$("#cont-poroda").val(contPoroda),$("#emp-name").val(Employer);for(var loaded_size=parseInt(localStorage.getItem("storeN")),i=1;loaded_size>=i;i++)storeNum="Num"+i,storeLen="Len"+i,storeDiam="Diam"+i,storeVal="Val"+i,Partia[i]={L:parseFloat(localStorage.getItem(storeLen)),Diam:parseInt(localStorage.getItem(storeDiam)),Val:parseInt(localStorage.getItem(storeVal))},totalV+=parseInt(localStorage.getItem(storeVal)),N++;$(".num").text("№ "+N),$("#total_val").val(totalV.toLocaleString()),$("#total_val_top").val(totalV.toLocaleString()),$("#max-val").val(localStorage.getItem("maxVal")),totalRest()}else console.log("!!!В ХРАНЛИЩЕ НЕТ ДАННЫХ!!!"),localStorage.setItem("storeN",0);var L_3_8=[],L_5_8=[],LM_2_9=[],LM_3_7=[],LM_3_8=[],LM_3_9=[];LM_2_9={12:0,14:50,16:66,18:83,20:103,22:125},LM_3_7={12:48,14:66,16:87,18:100,20:134,22:164},LM_3_8={12:50,14:68,16:90,18:113,20:139,22:170},LM_3_9={12:0,14:70,16:92,18:117,20:143,22:173},L_3_8={14:68,16:90,18:113,20:139,22:170,24:200,26:240,28:270,30:310,32:360,34:410,36:460,38:510,40:550,42:610,44:670,46:730,48:790,50:860,52:940,54:1020,56:1100,58:1180,60:1270,62:1350,64:1440,66:1530,68:1620,70:1710,72:1810,74:1910,76:2020,78:2120,80:2230,82:2350,84:2460,86:2580,88:2700,90:2830,92:2960,94:3080,96:3220,98:3350,100:3490},L_5_8={14:118,16:149,18:186,20:220,22:270,24:320,26:380,28:430,30:500,32:570,34:640,36:710,38:790,40:870,42:960,44:1050,46:1150,48:1250,50:1360,52:1470,54:1590,56:1710,58:1840,60:1970,62:2110,64:2240,66:2360,68:2490,70:2630,72:2770,74:2920,76:3080,78:3260,80:3430,82:3610,84:3780,86:3970,88:4170,90:4370,92:4580,94:4790,96:5010,98:5230,100:5450};var Diam="",temp_diam;$("#enter-styk").click(function(){result=confirm("Отметить стык?"),result&&(localStorage.getItem("Styk")?(Styk=localStorage.getItem("Styk")+","+(N-1),localStorage.setItem("Styk",Styk),errorMessages("Стык добавлен")):(Styk=N-1,0!=Styk&&(localStorage.setItem("Styk",Styk),errorMessages("Первый стык"))))}),$("#show_cont").click(function(){return $(".table-container-data").slideToggle(),!1}),$("#reset_cont").click(function(){return resetContainerData(),!1}),$("#save_cont").click(function(){localStorage.setItem("contNum",$("#cont-num").val()),localStorage.setItem("contLine",$("#cont-line").val()),localStorage.setItem("contGross",$("#gross-wt").val()),localStorage.setItem("contTare",$("#tare-wt").val()),localStorage.setItem("contPay",$("#pay-wt").val()),localStorage.setItem("contPoroda",$("#cont-poroda").val()),localStorage.setItem("Employer",$("#emp-name").val()),contNum=localStorage.getItem("contNum"),contLine=localStorage.getItem("contLine"),contGross=localStorage.getItem("contGross"),contTare=localStorage.getItem("contTare"),contPay=localStorage.getItem("contPay"),contPoroda=localStorage.getItem("contPoroda"),Employer=localStorage.getItem("Employer"),errorMessages("Данные сохранены")}),$(".choose-len-btn").click(function(){$(".fa-check").css("opacity","0"),$(this).prev("i").css("opacity","1"),Len=$(this).attr("len"),$("#diam").val(""),$("#val").val(""),D=0,V=0,Diam=""}),$("#max-val").keyup(function(){localStorage.setItem("maxVal",$(this).val()),totalRest()}),$("#diam").focus(function(){$(".numbers").show(),removeDataTable()}),$("#diam").keyup(function(){if(temp_diam=$(this).val(),!(temp_diam%2)){switch(D=$(this).val(),Len){case"38":V=L_3_8[D];break;case"58":V=L_5_8[D]}V?$("#val").val(V+"cм3"):(0>D||D>9)&&errorMessages("НЕТ ДАННЫХ ДЛЯ ДИАМЕТРА")}}),$(".numbers td").click(function(){if("del"!=$(this).attr("val")&&"ok"!=$(this).attr("val"))if(diam_temp=$(this).attr("val"),Diam+=diam_temp,$("#diam").val(Diam),temp_diam=$("#diam").val(),!(temp_diam%2)&&100>=temp_diam){switch(D=$("#diam").val(),Len){case"38":V=L_3_8[D];break;case"58":V=L_5_8[D]}V?$("#val").val(V+"cм3"):(0>D||D>9)&&errorMessages("НЕТ ДАННЫХ ДЛЯ ДИАМЕТРА")}else if(temp_diam>100){errorMessages("СЛИШКОМ БОЛЬШОЙ ДИАМЕТР");var t=$("#diam").val();Diam=t.substring(0,t.length-1),$("#diam").val(Diam),temp_diam=$("#diam").val()}else temp_diam%2>0&&(0>temp_diam||temp_diam>9)&&errorMessages("НЕЧЕТНЫЙ ДИАМЕТР");else if("ok"==$(this).attr("val"))$(".numbers").hide();else if("del"==$(this).attr("val")){diam_temp=$(this).attr("val");var t=$("#diam").val();if(t.length>1){var a=t.substring(0,t.length-1);if($("#diam").val(a),Diam=$("#diam").val(),$("#diam").val(Diam),temp_diam=$("#diam").val(),!(temp_diam%2)&&100>=temp_diam){switch(D=$("#diam").val(),Len){case"38":V=L_3_8[D];break;case"58":V=L_5_8[D]}V?$("#val").val(V+"cм3"):(errorMessages("НЕТ ДАННЫХ ДЛЯ ДИАМЕТРА"),$("#val").val(0))}}else $("#diam").val(0).trigger("focus"),$("#val").val("0cм3"),Diam="",D="",temp_diam=$("#diam").val();getValue()}}),$("#enter-diam").click(function(){if(Diam="",D>=12&&Len>0&&"undefined"!=typeof V){totalV+=V,$("#total_val").val(totalV.toLocaleString()+" cм3"),$("#total_val_top").val(totalV.toLocaleString()+" cм3"),maxV=localStorage.getItem("maxVal"),restVal=maxV-totalV,$("#max-val-rest").val(restVal.toLocaleString()),$("#max-val-rest").css(attention>restVal?{backgroundColor:"red",color:"white"}:{backgroundColor:"white",color:"black"}),Partia[N]={L:Len/10,Diam:D,Val:V};var t=Len/10,a=D,e=V;storeNum="Num"+N,storeLen="Len"+N,storeDiam="Diam"+N,storeVal="Val"+N,localStorage.setItem(storeNum,N),localStorage.setItem(storeLen,t),localStorage.setItem(storeDiam,a),localStorage.setItem(storeVal,e),localStorage.setItem("storeN",N),removeDataTable(),getAverageDiam(),N++,$(".num").text("№ "+N),$("#diam").val(""),$("#val").val(""),D=0,V=0,$("#diam").focus()}else D=0,V=0,errorMessages(0==Len?"НЕ ВЫБРАНА ДЛИНА":"НЕПРАВИЛЬНЫЙ ДИАМЕТР")});var flag=!0;$("#show_loading").click(function(){flag?($(this).text("СКРЫТЬ"),showData(),flag=!1,$(".numbers").hide()):removeDataTable()}),$("#delete").click(function(){return totalV?(result=confirm("Строка будет удалена. Продолжить?"),result&&(totalV-=Partia[N-1].Val,$("#total_val").val(totalV.toLocaleString()),$("#total_val_top").val(totalV.toLocaleString()),totalRest(),N--,Partia[N].L=0,Partia[N].Diam=0,Partia[N].Val=0,storeNum="Num"+N,storeLen="Len"+N,storeDiam="Diam"+N,storeVal="Val"+N,localStorage.setItem(storeNum,""),localStorage.setItem(storeLen,""),localStorage.setItem(storeDiam,""),localStorage.setItem(storeVal,""),localStorage.setItem("storeN",N-1),console.log(localStorage.getItem("storeN")),$(".num").text("№ "+N),$(".table-res tr td").remove(),showData())):errorMessages("НЕТ ДАННЫХ ДЛЯ УДАЛЕНИЯ"),!1}),$(".show-sos").click(function(){return $(".sos-wrapper").css("display","block"),!1}),$(".sos-btn").click(function(){Partia.length=0,$(".table-res tr td").remove(),N=parseInt($("#last-N").val()),N++,$(".num").text("№ "+N);for(var t=0;N>t;t++)Partia[t]={L:0,Diam:0,Val:0};return totalV=parseInt($("#last-totalV").val()),$("#total_val").val(totalV),$("#total_val_top").val(totalV),showParam(),$(".sos-wrapper").hide(),!1}),$("#next-cont").click(function(){result=confirm("Все данные будут удалены!!!\nНе забудьте синхронизироваться!\nПродолжить?"),result&&($(".table-res tr td").remove(),Partia.length=0,$(".fa-check").css("opacity","0"),allReset(),localStorage.clear())}),$("#switch-on-melcodrev").click(function(){$(".melcodrev").show(),allMelcodrevReset(),$("body,html").animate({scrollTop:0},600)}),$("#switch-of-melcodrev").click(function(){$(".melcodrev").hide()}),$("#reset-melcodrev").click(function(){allMelcodrevReset()}),$("#Lmd").change(function(){allMelcodrevReset()}),$("#diam12, #diam14, #diam16, #diam18").focus(function(){var t=$(this).val();$(this).val(t>0?t:"")}),$("#diam12, #diam14, #diam16, #diam18").blur(function(){var t=$(this).val();$(this).val(t>0?t:"0")}),$("#diam12, #diam14, #diam16, #diam18").keyup(function(){switch(Lmd=$("#Lmd").val(),console.log("Lmd = "+Lmd),D=$(this).attr("diam"),Lmd){case"LM_2_9":V=LM_2_9[D];break;case"LM_3_7":V=LM_3_7[D];break;case"LM_3_8":V=LM_3_8[D];break;case"LM_3_9":V=LM_3_9[D]}var t="#diam"+D,a="#val"+D;$(a).val($(t).val()*V),$("#diam_total").val(parseInt($("#diam12").val())+parseInt($("#diam14").val())+parseInt($("#diam16").val())+parseInt($("#diam18").val())),$("#val_total").val(parseInt($("#val12").val())+parseInt($("#val14").val())+parseInt($("#val16").val())+parseInt($("#val18").val()))}),$("#sinhro").click(function(){if(result=confirm("Данные будут отправлены в хранилище. Продолжить?"))if(contNum=localStorage.getItem("contNum"),contLine=localStorage.getItem("contLine"),contGross=localStorage.getItem("contGross"),contTare=localStorage.getItem("contTare"),contPay=localStorage.getItem("contPay"),contPoroda=localStorage.getItem("contPoroda"),Employer=localStorage.getItem("Employer"),Styk=localStorage.getItem("Styk"),contNum&&contLine&&contGross&&contTare&&contPay&&contPoroda&&Employer){var t={contNum:contNum,contLine:contLine,contGross:contGross,contTare:contTare,contPay:contPay,contPoroda:contPoroda,Employer:Employer,Partia:Partia,Styk:Styk};$.ajax({url:"http://les2.radov.xyz/controller.php",type:"post",data:{save_loading:"yesss",DATA:t},dataType:"json",success:function(t){errorMessages(t.message),alert("Данные успешно отправлены.")}})}else errorMessages("Введены не все данные контейнера");return!1}),$(".numbers td").dblclick(function(){$(this).trigger("click")}),$(".to-top").click(function(){return $("body,html").animate({scrollTop:0},600),!1});